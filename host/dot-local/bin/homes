#!/bin/bash

set -e

eval "$(/var/home/linuxbrew/.linuxbrew/bin/brew shellenv)"

cd $HOME

choice=$(
  fd --max-depth 1 . Homes/* |
    sed 's"Homes/""' |
    sed 's"/$""' |
    sort |
    fzf --reverse --margin 0,25% --no-info --prompt=""
)

[[ -z $choice ]] && exit

path=$HOME/Homes/$choice

cd $path

if [[ -f $path/../.config/kitty/session.conf ]] ; then
  session_arg="--session=session.conf"
fi

exec distrobox enter $(dirname $choice) -- kitty --detach $session_arg
