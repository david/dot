- name: .config
  ansible.builtin.file:
    path: "{{ home }}/.config"
    mode: "0755"
    state: directory
  tags:
    - config
    - files

- name: "create config subdirs"
  ansible.builtin.file:
    path: "{{ home }}/.config/{{ item.path }}"
    mode: "0755"
    state: directory
  with_community.general.filetree:
    - home-config/
    - secrets-config/
  when: item.state == 'directory'
  tags:
    - config
    - files

- name: "link config files"
  ansible.builtin.file:
    src: "{{ item.src }}"
    path: "{{ home }}/.config/{{ item.path }}"
    state: link
  with_community.general.filetree:
    - home-config/
    - secrets-config/
  when: item.state == 'file'
  tags:
    - config
    - files

- name: "remove default files"
  ansible.builtin.file:
    path: "{{ item }}"
    state: absent
  loop:
    - "{{ home }}/.bashrc"
    - "{{ home }}/.bash_profile"
    - "{{ home }}/.profile"
  when: item is not link
  tags:
    - config
    - files

- name: "link home root files"
  ansible.builtin.file:
    src: "{{ item.src }}"
    path: "{{ home }}/.{{ item.path }}"
    state: link
  with_community.general.filetree: "home/"
  when: item.path is not link
  tags:
    - config
    - files

- name: .local
  ansible.builtin.file:
    path: "{{ home }}/.local"
    mode: "0755"
    state: directory
  tags:
    - assets
    - files

- name: .local
  ansible.builtin.file:
    path: "{{ home }}/.local/share"
    mode: "0755"
    state: directory
  tags:
    - assets
    - files

- name: "create asset subdirs"
  ansible.builtin.file:
    path: "{{ home }}/.local/share/{{ item.path | regex_replace('^_', '.') }}"
    mode: "0755"
    state: directory
  with_community.general.filetree: "{{ assets }}"
  when: item.state == 'directory'
  tags:
    - assets
    - files

- name: "link asset files"
  ansible.builtin.file:
    src: "{{ item.src }}"
    path: "{{ home }}/.local/share/{{ item.path | regex_replace('^_', '.') }}"
    state: link
  with_community.general.filetree: "{{ assets }}"
  when: item.state == 'file'
  tags:
    - assets
    - files

# vim:ft=yaml.ansible
