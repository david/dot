#!/usr/bin/env bash

set -euo pipefail

script_dir="$(realpath $(dirname ${BASH_SOURCE[0]}))"
base_dir="$(dirname $script_dir)"

packages=""

if [[ -d "${base_dir}/hosts/${CONTAINER_ID}/npm" ]] ; then
  for f in ${base_dir}/hosts/${CONTAINER_ID}/npm/* ; do
    packages="${packages} $(cat $f)"
  done
fi

case "${1:-}" in
  sync)
    npm i --global ${packages[@]}
    ;;

  *)
    >&2 echo "usage: $0 sync"
    exit 1
esac

# vim: ft=bash
